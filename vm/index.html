<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>虚拟机控制台</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="header">
        <h1>🖥️ 虚拟机控制台</h1>
        <div class="controls">
            <button id="startBtn" class="btn">▶️ 启动</button>
            <button id="stopBtn" class="btn">⏹️ 停止</button>
            <button id="resetBtn" class="btn">🔄 重启</button>
            <button id="fullscreenBtn" class="btn">⛶ 全屏</button>
            <button id="uploadBtn" class="btn">📤 重新上传</button>
            <a href="/" class="btn">🏠 返回主页</a>
        </div>
    </div>

    <div class="main-container">
        <div class="vm-container">
            <div id="vm-screen" class="screen"></div>
        </div>

        <div class="sidebar">
            <div class="panel">
                <h3>📊 系统状态</h3>
                <div id="system-info">
                    <p>状态: <span id="vm-status">未启动</span></p>
                    <p>CPU: <span id="cpu-usage">0%</span></p>
                    <p>内存: <span id="memory-info">0MB/0MB</span></p>
                    <p>网络: <span id="network-status">未连接</span></p>
                    <p>ISO: <span id="iso-info">-</span></p>
                </div>
            </div>

            <div class="panel">
                <h3>💾 存储设备</h3>
                <div class="storage-info">
                    <div class="storage-item">
                        <strong>CD-ROM:</strong>
                        <span id="cdrom-info">等待上传</span>
                    </div>
                    <div class="storage-item">
                        <strong>硬盘:</strong>
                        <span id="hdd-info">无</span>
                    </div>
                    <button class="action-btn" onclick="mountISO()">💿 挂载 ISO</button>
                    <button class="action-btn" onclick="createVirtualDisk()">💾 创建虚拟硬盘</button>
                </div>
            </div>

            <div class="panel">
                <h3>⚡ 快捷操作</h3>
                <div class="quick-actions">
                    <button class="action-btn" onclick="sendCtrlAltDel()">Ctrl+Alt+Del</button>
                    <button class="action-btn" onclick="takeScreenshot()">📸 截图</button>
                    <button class="action-btn" onclick="saveState()">💾 保存状态</button>
                    <button class="action-btn" onclick="loadState()">📂 加载状态</button>
                </div>
            </div>

            <div class="panel">
                <h3>🔧 系统信息</h3>
                <div class="system-details">
                    <p><strong>CPU:</strong> Intel 486</p>
                    <p><strong>内存:</strong> 128MB</p>
                    <p><strong>显卡:</strong> VGA Compatible</p>
                    <p><strong>声卡:</strong> Sound Blaster 16</p>
                </div>
            </div>
        </div>
    </div>

    <div class="loading" id="loading">
        <div class="spinner"></div>
        <p id="loading-text">正在初始化虚拟机环境...</p>
        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress" id="progress"></div>
            </div>
            <span id="progress-text">0%</span>
        </div>
        <div class="loading-details" id="loading-details">
            准备启动...
        </div>
    </div>

    <div class="modal" id="iso-upload-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>📤 上传 ISO 文件</h2>
                <span class="close" onclick="closeModal('iso-upload-modal')">&times;</span>
            </div>
            <div class="modal-body">
                <div class="upload-area" id="modalUploadArea">
                    <div class="upload-icon">📁</div>
                    <h3>选择 ISO 文件</h3>
                    <p>请选择要运行的系统镜像文件</p>
                    <input type="file" id="modalIsoFile" accept=".iso" style="display: none;">
                    <button class="btn" onclick="document.getElementById('modalIsoFile').click()">选择文件</button>
                </div>
                
                <div class="file-info" id="modalFileInfo" style="display: none;">
                    <h3>📄 文件信息</h3>
                    <p><strong>文件名:</strong> <span id="modalFileName">-</span></p>
                    <p><strong>文件大小:</strong> <span id="modalFileSize">-</span></p>
                    <button class="btn btn-success" onclick="confirmISOUpload()">确认上传</button>
                </div>
            </div>
        </div>
    </div>

    <script src="v86.js"></script>
    <script src="js/emulator.js"></script>
</body>
</html>
